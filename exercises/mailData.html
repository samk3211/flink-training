<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Mail Data Set</title>
    <meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.
">

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">

    <link rel="stylesheet" href="/flink-training/css/main.css">
    <link rel="canonical" href="http://dataartisans.github.io/flink-training/exercises/mailData.html">
    <link rel="alternate" type="application/rss+xml" title="Apache Flink Training" href="http://dataartisans.github.io/flink-training/feed.xml" />
  </head>

  <body>
    <nav class="navbar navbar-default">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/flink-training/index.html">Apache Flink Training<sup>&reg;</sup></a>
      
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

        <!-- Lessons -->
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Lessons<span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <!-- System Overview --> 
            <li><a href="/flink-training/overview/intro.html">1. System Overview</a></li>
            <li><a href="/flink-training/overview/slides.html">Lecture</a></li>
            <li class="divider"></li>
            <!-- Local Setup -->
            <li><a href="/flink-training/devSetup/intro.html">2. Setup Development Environment</a></li>
            <li><a href="/flink-training/devSetup/handsOn.html">Hands-On</a></li>
            <li class="divider"></li>
            <!-- DataSet Basics -->
            <li><a href="/flink-training/dataSetBasics/intro.html">3. DataSet API Basics</a></li>
            <li><a href="/flink-training/dataSetBasics/slides.html">Lecture</a></li>
            <li><a href="/flink-training/dataSetBasics/handsOn.html">Hands-On</a></li>
            <li class="divider"></li>
            <!-- DataSet Advanced -->
            <li><a href="/flink-training/dataSetAdvanced/intro.html">4. DataSet API Advanced</a></li>
            <li><a href="/flink-training/dataSetAdvanced/slides.html">Lecture</a></li>
            <li><a href="/flink-training/dataSetAdvanced/handsOn.html">Hands-On</a></li>
            <li class="divider"></li>
            <!-- Table API -->
            <li><a href="/flink-training/tableApi/intro.html">5. Table API</a></li>
            <li><a href="/flink-training/tableApi/slides.html">Lecture</a></li>
            <li><a href="/flink-training/tableApi/handsOn.html">Hands-On</a></li>
            <li class="divider"></li>
            <!-- Closing -->
            <li><a href="/flink-training/closing/intro.html">6. Closing</a></li>
            <li><a href="/flink-training/closing/slides.html">Slides</a></li>
          </ul>
        </li>

        <!-- Exercises --> 
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Exercises<span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li><a href="/flink-training/exercises/">Overview</a></li>
            <li class="divider"></li>
            <li><a href="/flink-training/exercises/mailCount.html">DataSet API: Mail Count</a></li>
            <li><a href="/flink-training/exercises/replyGraph.html">DataSet API: Reply Graph Extraction</a></li>
            <li><a href="/flink-training/exercises/tfIdf.html">DataSet API: TF-IDF</a></li>
            <li class="divider"></li>
            <li><a href="/flink-training/exercises/memberOTM.html">Table API: Member of the Month</a></li>
            <li class="divider"></li>
            <li><a href="/flink-training/exercises/mailData.html">Mail Data Set</a></li>
          </ul>
        </li>

        <!-- Documentation Links -->  
        <li><a href="/flink-training/devResources/docLinks.html">Flink Documentation</a></li>

        <!--
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Resources<span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li><a href="/flink-training/devResources/docLinks.html">Flink Documentation</a></li>
            <li><a href="/flink-training/devResources/trainingSlides.html">Training Slides</a></li>
            <li class="divider"></li>
            <li><a href="/flink-training/devResources/bestPractices.html">Best Practices</a></li>
            <li><a href="/flink-training/devResources/tuning.html">Tuning</a></li>
            <li><a href="/flink-training/devResources/exceptionFaq.html">Exception FAQ</a></li>
          </ul>
        </li>
        -->
      </ul>
      <!--
      <ul class="nav navbar-nav navbar-right">
        <li><a href="#">Link</a></li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Dropdown <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li><a href="#">Action</a></li>
            <li><a href="#">Another action</a></li>
            <li><a href="#">Something else here</a></li>
            <li class="divider"></li>
            <li><a href="#">Separated link</a></li>
          </ul>
        </li>
      </ul>
    -->
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Mail Data Set</h1>
  </header>

  <article class="post-content">
    <p>All communication within Apache projects is happening on or is mirrored to mailing lists. Most of these lists are public and archived. The Mail Data Set is derived from the public archives of Apache Flink’s developer and issues mailing lists (dev@flink.apache.org and issues@flink.apache.org).</p>

<h3 id="download-the-mail-data-set">1. Download the Mail Data Set</h3>

<p>Download and extract the Mail Data Set by running the following commands</p>

<pre><code>wget https://raw.githubusercontent.com/dataArtisans/flink-training/master/dataSets/flinkMails.tar.gz
tar xvfz flinkMails.tar.gz
</code></pre>

<p>The resulting <code>flinkMails.del</code> file contains the Mail Data Set.</p>

<h4 id="data-format-of-the-mail-data-set">Data format of the Mail Data Set</h4>

<p>The Mail Data Set is formatted in a delimited text format. Email records are separated by a “<code>##//##</code>” char sequence.
Each mail record has six fields:</p>

<pre><code>MessageID  : String // a unique message id
Timestamp  : String // the mail deamon timestamp
Sender     : String // the sender of the mail
Subject    : String // the subject of the mail
Body       : String // the body of the mail (contains linebrakes)
Replied-To : String // the messageID of the mail this mail was replied to 
                    //   (may be “null”)
</code></pre>

<p>which are separated by a “<code>#|#</code>” char sequence.</p>

<p>Hence, the format of the file is </p>

<pre><code>&lt;MessageID&gt;#|#&lt;Timestamp&gt;#|#&lt;Sender&gt;#|#&lt;Subject&gt;#|#&lt;Body&gt;#|#&lt;RepliedTo&gt;##//##&lt;MessageId&gt;#|#TimeStamp&gt;#|#...
</code></pre>

<h3 id="read-the-mail-data-set-in-a-flink-program">2. Read the Mail Data Set in a Flink program</h3>

<p>The Mail Data Set can be read using Flink’s <code>CsvInputFormat</code>:</p>

<h4 id="java">Java</h4>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// get an ExecutionEnvironment</span>
<span class="n">ExecutionEnvironment</span> <span class="n">env</span> <span class="o">=</span> <span class="n">ExecutionEnvironment</span><span class="o">.</span><span class="na">getExecutionEnvironment</span><span class="o">();</span>

<span class="c1">// read all fields</span>
<span class="n">DataSet</span><span class="o">&lt;</span><span class="n">Tuple6</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">mails</span> <span class="o">=</span>
  <span class="n">env</span><span class="o">.</span><span class="na">readCsvFile</span><span class="o">(</span><span class="s">&quot;/your/output/mail-data&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="na">lineDelimiter</span><span class="o">(</span><span class="s">&quot;##//##&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="na">fieldDelimiter</span><span class="o">(</span><span class="s">&quot;#|#&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="na">types</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
           <span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

<span class="c1">// read sender and body fields</span>
<span class="n">DataSet</span><span class="o">&lt;</span><span class="n">Tuple2</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">senderBody</span> <span class="o">=</span>
  <span class="n">env</span><span class="o">.</span><span class="na">readCsvFile</span><span class="o">(</span><span class="s">&quot;/your/output/mail-data&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="na">lineDelimiter</span><span class="o">(</span><span class="s">&quot;##//##&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="na">fieldDelimiter</span><span class="o">(</span><span class="s">&quot;#|#&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="na">includeFields</span><span class="o">(</span><span class="s">&quot;00101&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="na">types</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span></code></pre></div>

<h4 id="scala">Scala</h4>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// get an ExecutionEnvironment</span>
<span class="k">val</span> <span class="n">env</span> <span class="k">=</span> <span class="nc">ExecutionEnvironment</span><span class="o">.</span><span class="n">getExecutionEnvironment</span>

<span class="c1">// read all fields</span>
<span class="k">val</span> <span class="n">mails</span> <span class="k">=</span> <span class="n">env</span><span class="o">.</span><span class="n">readCsvFile</span><span class="o">[(</span><span class="kt">String</span>, <span class="kt">String</span>, <span class="kt">String</span>, <span class="kt">String</span>, <span class="kt">String</span>, <span class="kt">String</span><span class="o">)](</span>
    <span class="s">&quot;/your/output/mail-data&quot;</span><span class="o">,</span>
    <span class="n">lineDelimiter</span> <span class="k">=</span> <span class="s">&quot;##//##&quot;</span><span class="o">,</span>
    <span class="n">fieldDelimiter</span> <span class="k">=</span> <span class="s">&quot;#|#&quot;</span><span class="o">,</span>
  <span class="o">)</span>

<span class="c1">// read sender and body fields</span>
<span class="k">val</span> <span class="n">senderBody</span> <span class="k">=</span> <span class="n">env</span><span class="o">.</span><span class="n">readCsvFile</span><span class="o">[(</span><span class="kt">String</span>, <span class="kt">String</span><span class="o">)](</span>
    <span class="s">&quot;/your/output/mail-data&quot;</span><span class="o">,</span>
    <span class="n">lineDelimiter</span> <span class="k">=</span> <span class="s">&quot;##//##&quot;</span><span class="o">,</span>
    <span class="n">fieldDelimiter</span> <span class="k">=</span> <span class="s">&quot;#|#&quot;</span><span class="o">,</span>
    <span class="n">includedFields</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span><span class="mi">4</span><span class="o">)</span>
  <span class="o">)</span></code></pre></div>

  </article>

</div>

      
        <!-- Footer -->
        <div class="site-footer text-center">
          <p>Copyright © 2015 <a href="http://data-artisans.com">dataArtisans</a>. All Rights Reserved.</p>

          <p>Apache Flink, Apache, and the Apache feather logo are trademarks of The Apache Software Foundation.</p>
        </div>
      </div>
    </div>

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    
  </body>
</html>
